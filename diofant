#!/usr/bin/env coffee
spawn = require("child_process").spawn
argv = require("optimist").argv
path = require "path"
fs = require "fs"


problemResult = (problem) ->
  problem = require path.join __dirname, "src", String problem
  problem.result


if argv.result
  if argv.problem
    console.log problemResult argv.problem

  else
    files = fs.readdirSync path.join __dirname, "src"

    for file in files
      matches = /^(\d+)\.coffee$/.exec file

      if matches
        problem = matches[1]
        console.log "#{problem}: #{problemResult problem}"

else
  if argv.problem
    process.env.GREP = "##{argv.problem} "

  mocha = spawn "grunt", ["simplemocha"], cwd: __dirname
  mocha.stdout.pipe process.stdout
